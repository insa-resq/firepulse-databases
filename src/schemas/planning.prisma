model Planning {
    id               String            @id @default(cuid(2))
    createdAt        DateTime          @default(now())
    updatedAt        DateTime          @updatedAt
    year             Int
    weekNumber       Int
    status           PlanningStatus    @default(GENERATING)
    stationId        String
    station          FireStation       @relation(fields: [stationId], references: [id], onDelete: Cascade)
    shiftAssignments ShiftAssignment[]

    @@unique([year, weekNumber, stationId])
    @@schema("planning")
}

model ShiftAssignment {
    id            String      @id @default(cuid(2))
    createdAt     DateTime    @default(now())
    updatedAt     DateTime    @updatedAt
    weekday       Weekday
    shiftType     ShiftType
    firefighterId String
    firefighter   Firefighter @relation(fields: [firefighterId], references: [id], onDelete: Cascade)
    planningId    String
    planning      Planning    @relation(fields: [planningId], references: [id], onDelete: Cascade)

    @@unique([planningId, weekday, firefighterId])
    @@schema("planning")
}

model AvailabilitySlot {
    id            String      @id @default(cuid(2))
    createdAt     DateTime    @default(now())
    updatedAt     DateTime    @updatedAt
    year          Int
    weekNumber    Int
    weekday       Weekday
    isAvailable   Boolean
    firefighterId String
    firefighter   Firefighter @relation(fields: [firefighterId], references: [id], onDelete: Cascade)

    @@unique([firefighterId, year, weekNumber, weekday])
    @@index([year, weekNumber, weekday, isAvailable])
    @@schema("planning")
}

enum PlanningStatus {
    GENERATING
    FINALIZED

    @@schema("planning")
}

enum Weekday {
    MONDAY
    TUESDAY
    WEDNESDAY
    THURSDAY
    FRIDAY
    SATURDAY
    SUNDAY

    @@schema("planning")
}

enum ShiftType {
    ON_SHIFT // Actively working a shift
    OFF_DUTY // Not available
    ON_CALL // Available to be called in case of emergency

    @@schema("planning")
}
